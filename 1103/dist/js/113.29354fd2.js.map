{"version":3,"file":"js/113.29354fd2.js","mappings":"8dAqEA,MAAMA,GAASC,EAAAA,EAAAA,MACTC,GAAQC,EAAAA,EAAAA,MACRC,GAAUC,EAAAA,EAAAA,IAAO,WACjBC,GAAWC,EAAAA,EAAAA,IAAI,CACnBC,GAAI,GACJC,WAAY,GACZC,SAAU,GACVC,SAAU,GACVC,WAAY,GACZC,WAAY,GACZC,KAAM,GACNC,KAAM,GACNC,YAAa,IAGTC,EAAgB,CACpBR,WAAY,CAAC,CAAES,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAC5DV,SAAU,CACR,CAAEQ,UAAU,EAAMC,QAAS,UAAWC,QAAS,QAC/C,CAAEC,QAAS,QAASF,QAAS,aAAcC,QAAS,SAEtDT,SAAU,CAAC,CAAEO,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAC1DR,WAAY,CAAC,CAAEM,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAC5DP,WAAY,CACV,CAAEK,UAAU,EAAMC,QAAS,YAAaC,QAAS,SAEnDN,KAAM,CAAC,CAAEI,UAAU,EAAMC,QAAS,UAAWC,QAAS,SACtDL,KAAM,CAAC,CAAEG,UAAU,EAAMC,QAAS,UAAWC,QAAS,SACtDJ,YAAa,CACX,CAAEE,UAAU,EAAMC,QAAS,UAAWC,QAAS,QAC/C,CACEC,QAAS,eACTF,QAAS,aACTC,QAAS,UAKTE,GAAYf,EAAAA,EAAAA,KAAI,GAChBgB,EAAW,KACfjB,EAASkB,MAAMhB,GAAKN,EAAMuB,OAAOjB,GACjCc,EAAUE,OAAQ,EAClBE,EAAAA,EAAAA,UAAAA,SACYpB,EAASkB,MAAMhB,IACxBmB,MAAMC,IACLtB,EAASkB,MAAQI,EAAOC,QAEzBC,SAAQ,KACPR,EAAUE,OAAQ,MAGxBD,IAEA,MAAMQ,GAASxB,EAAAA,EAAAA,IAAI,MAEbyB,EAAwBJ,IAC5BtB,EAASkB,MAAMb,SAAWiB,EAAOC,KACjCI,EAAAA,GAAAA,QAAkB,SAGdC,EAAuBC,GACtB,wCAAwCC,KAAKD,EAAQE,QAG/CF,EAAQG,KAAO,KAAO,KAAO,KACtCL,EAAAA,GAAAA,MAAgB,iBACT,IAJPA,EAAAA,GAAAA,MAAgB,YACT,GAQLM,EAAa,KACjBR,EAAOP,MAAMgB,UAAUC,IACjBA,EACFC,IAEAT,EAAAA,GAAAA,MAAgB,gBAMhBU,GAAcpC,EAAAA,EAAAA,KAAI,GAClBmC,EAAW,KACfC,EAAYnB,OAAQ,EACpBE,EAAAA,EAAAA,UAAAA,OACUpB,EAASkB,MAAMhB,GAAIF,EAASkB,OACnCG,MAAMiB,IACLX,EAAAA,GAAAA,QAAkB,QAClBjC,EAAO6C,QAAQ,CAAEC,KAAM,qBAExBhB,SAAQ,KACPa,EAAYnB,OAAQ,MAIpBuB,EAAY,KAChBhB,EAAOP,MAAMwB,e,wmGChKf,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE","sources":["webpack://movie-manager/./src/views/movieInfo/EditMovieInfo.vue","webpack://movie-manager/./src/views/movieInfo/EditMovieInfo.vue?8c37"],"sourcesContent":["<template>\r\n  <el-card>\r\n    <template #header>\r\n      <div class=\"flex flex-row justify-between\">\r\n        <span>编辑电影</span>\r\n        <router-link class=\" text-blue-500\" :to=\"{name:'MovieInfoList'}\">返回列表</router-link>\r\n      </div>\r\n    </template>\r\n    <el-skeleton :rows=\"8\" animated :loading=\"isLoading\">\r\n      <el-form\r\n        label-width=\"120px\"\r\n        :model=\"formData\"\r\n        :rules=\"formDataRules\"\r\n        ref=\"formEl\">\r\n        <el-form-item label=\"电影名称\" prop=\"movie_name\">\r\n          <el-input placeholder=\"请输入管理员名称\" v-model=\"formData.movie_name\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"电影时长\" prop=\"duration\">\r\n          <el-input placeholder=\"请输入电影时长\" v-model=\"formData.duration\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"电影图片\" prop=\"movie_pc\">\r\n          <el-upload\r\n            class=\"upload-box w-[120px] h-[150px] border-dashed border border-gray-500 flex justify-center items-center\"\r\n            :action=\"baseURL + '/movie-info/uploadMoviePc'\"\r\n            :show-file-list=\"false\"\r\n            :on-success=\"uploadMoviePcSuccess\"\r\n            :before-upload=\"beforeMoviePcUpload\"\r\n            name=\"movie_pc\">\r\n            <img v-if=\"formData.movie_pc\" :src=\"baseURL+formData.movie_pc\" class=\"avatar\" />\r\n            <el-icon v-else :size=\"60\">\r\n              <PictureFilled />\r\n            </el-icon>\r\n          </el-upload>\r\n        </el-form-item>\r\n        <el-form-item label=\"上映时间\" prop=\"publicTime\">\r\n          <el-date-picker\r\n            v-model=\"formData.publicTime\"\r\n            type=\"date\"\r\n            placeholder=\"请选择上映日期\"\r\n            value-format=\"YYYY-MM-DD\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"电影类型\" prop=\"tags\">\r\n          <el-input placeholder=\"请输入电影类型 ，用空格隔开\" v-model=\"formData.tags\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"主演人员\" prop=\"role\">\r\n          <el-input placeholder=\"请输入主演人员，用空格隔开\" v-model=\"formData.role\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"电影评分\" prop=\"movie_score\">\r\n          <el-input-number placeholder=\"请输入电影评分\" v-model=\"formData.movie_score\" :precision=\"1\" :step=\"0.1\" :max=\"9.9\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"电影简介\" prop=\"movie_desc\">\r\n          <el-input placeholder=\"请输入电影简介\" v-model=\"formData.movie_desc\" type=\"textarea\" rows=\"8\" />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"isSubmiting\">保存数据</el-button>\r\n          <el-button type=\"danger\" @click=\"resetForm\">重置表单</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-skeleton>\r\n\r\n  </el-card>\r\n</template>\r\n<script setup>\r\nimport { ref, reactive, inject, onMounted } from \"vue\";\r\nimport { PictureFilled } from \"@element-plus/icons-vue\";\r\nimport { ElMessage } from \"element-plus\";\r\nimport API from \"@/utils/API\";\r\nimport { useRouter, useRoute } from \"vue-router\";\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\nconst baseURL = inject(\"baseURL\");\r\nconst formData = ref({\r\n  id: \"\",\r\n  movie_name: \"\",\r\n  duration: \"\",\r\n  movie_pc: \"\",\r\n  movie_desc: \"\",\r\n  publicTime: \"\",\r\n  tags: [],\r\n  role: \"\",\r\n  movie_score: 0,\r\n});\r\n\r\nconst formDataRules = {\r\n  movie_name: [{ required: true, message: \"请输入电影名称\", trigger: \"blur\" }],\r\n  duration: [\r\n    { required: true, message: \"请输入电影时长\", trigger: \"blur\" },\r\n    { pattern: /^\\d+$/, message: \"请输入正确的电影时长\", trigger: \"blur\" },\r\n  ],\r\n  movie_pc: [{ required: true, message: \"请输入电影海报\", trigger: \"blur\" }],\r\n  movie_desc: [{ required: true, message: \"请输入电影描述\", trigger: \"blur\" }],\r\n  publicTime: [\r\n    { required: true, message: \"请输入电影上映时间\", trigger: \"blur\" },\r\n  ],\r\n  tags: [{ required: true, message: \"请输入电影标签\", trigger: \"blur\" }],\r\n  role: [{ required: true, message: \"请输入电影角色\", trigger: \"blur\" }],\r\n  movie_score: [\r\n    { required: true, message: \"请输入电影评分\", trigger: \"blur\" },\r\n    {\r\n      pattern: /^\\d(\\.\\d+)?$/,\r\n      message: \"请输入正确的电影评分\",\r\n      trigger: \"blur\",\r\n    },\r\n  ],\r\n};\r\n\r\nconst isLoading = ref(false);\r\nconst findById = () => {\r\n  formData.value.id = route.params.id;\r\n  isLoading.value = true;\r\n  API.movieInfo\r\n    .findById(formData.value.id)\r\n    .then((result) => {\r\n      formData.value = result.data;\r\n    })\r\n    .finally(() => {\r\n      isLoading.value = false;\r\n    });\r\n};\r\nfindById();\r\n\r\nconst formEl = ref(null);\r\n\r\nconst uploadMoviePcSuccess = (result) => {\r\n  formData.value.movie_pc = result.data;\r\n  ElMessage.success(\"上传成功\");\r\n};\r\n\r\nconst beforeMoviePcUpload = (rawFile) => {\r\n  if (!/^image\\/(jpe?g|png|gif|svg|webp|bmp)$/.test(rawFile.type)) {\r\n    ElMessage.error(\"请选择图片格式\");\r\n    return false;\r\n  } else if (rawFile.size / 1024 / 1024 > 2) {\r\n    ElMessage.error(\"图片大小不能超过2MB!\");\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nconst submitForm = () => {\r\n  formEl.value.validate((valid) => {\r\n    if (valid) {\r\n      saveData();\r\n    } else {\r\n      ElMessage.error(\"请将信息填写完整\");\r\n    }\r\n  });\r\n};\r\n\r\n//保存数据\r\nconst isSubmiting = ref(false);\r\nconst saveData = () => {\r\n  isSubmiting.value = true;\r\n  API.movieInfo\r\n    .update(formData.value.id, formData.value)\r\n    .then((res) => {\r\n      ElMessage.success(\"添加成功\");\r\n      router.replace({ name: \"MovieInfoList\" });\r\n    })\r\n    .finally(() => {\r\n      isSubmiting.value = false;\r\n    });\r\n};\r\n\r\nconst resetForm = () => {\r\n  formEl.value.resetFields();\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n.upload-box {\r\n  overflow: hidden;\r\n  img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: contain;\r\n  }\r\n}\r\n</style>","import script from \"./EditMovieInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./EditMovieInfo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./EditMovieInfo.vue?vue&type=style&index=0&id=9a644ca2&scoped=true&lang=scss\"\n\nimport exportComponent from \"D:\\\\杨标的工作文件\\\\学校文件\\\\华夏学院\\\\2022软工暑假实训\\\\movie-manager-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9a644ca2\"]])\n\nexport default __exports__"],"names":["router","useRouter","route","useRoute","baseURL","inject","formData","ref","id","movie_name","duration","movie_pc","movie_desc","publicTime","tags","role","movie_score","formDataRules","required","message","trigger","pattern","isLoading","findById","value","params","API","then","result","data","finally","formEl","uploadMoviePcSuccess","ElMessage","beforeMoviePcUpload","rawFile","test","type","size","submitForm","validate","valid","saveData","isSubmiting","res","replace","name","resetForm","resetFields","__exports__"],"sourceRoot":""}