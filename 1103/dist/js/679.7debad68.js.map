{"version":3,"file":"js/679.7debad68.js","mappings":"kxBAkFA,MAAMA,GAASC,EAAAA,EAAAA,MACTC,GAAWC,EAAAA,EAAAA,IAAS,CACxBC,UAAW,GACXC,KAAM,GACNC,MAAO,GACPC,QAAS,KAGLC,GAAaC,EAAAA,EAAAA,IAAI,KAGvBC,EAAAA,EAAAA,KACE,IAAMF,IACN,CAACG,EAAUC,KACTV,EAASI,MAAQO,KAAKC,UAAUN,EAAWO,SAE7C,CAAEC,MAAM,IAGV,MAAMC,EAAgB,CACpBb,UAAW,CAAC,CAAEc,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAC3Df,KAAM,CAAC,CAAEa,UAAU,EAAMC,QAAS,UAAWC,QAAS,SACtDd,MAAO,CAAC,CAAEY,UAAU,EAAMC,QAAS,UAAWC,QAAS,SACvDb,QAAS,CAAC,CAAEW,UAAU,EAAMC,QAAS,UAAWC,QAAS,UAGrDC,GAASZ,EAAAA,EAAAA,IAAI,MAGba,EAAY,KAChBd,EAAWO,MAAMQ,KAAK,KAIlBC,EAAoBC,IACxBC,EAAAA,EAAAA,QAAqB,aAAc,MAAO,CACxCC,kBAAmB,KACnBC,iBAAkB,KAClBC,KAAM,YACLC,MAAK,KACNtB,EAAWO,MAAMgB,OAAON,EAAO,OAK7BO,EAAc,KAClB,GAAIxB,EAAWO,MAAMkB,OAAS,EAAG,CAC/B,MAAMC,EAAU1B,EAAWO,MAAMP,EAAWO,MAAMkB,OAAS,GAC3DzB,EAAWO,MAAMQ,KAAK,IAAIW,SAE1BC,EAAAA,GAAAA,MAAgB,WAIdC,EAAgB,CAACC,EAAOC,KAC5BD,EAAME,aAAaC,QAAQ,OAAQF,IAI/BG,EAAe,CAACJ,EAAOZ,KAC3B,IAAIa,EAAOD,EAAME,aAAaG,QAAQ,QACtClC,EAAWO,MAAMU,GAAOF,MAAMe,IAI1BK,EAAa,KACjBtB,EAAON,MAAM6B,UAAUC,IACjBA,EACFC,IAEAX,EAAAA,GAAAA,MAAgB,gBAMhBY,GAActC,EAAAA,EAAAA,KAAI,GAClBqC,EAAW,KACfC,EAAYhC,OAAQ,EACpBiC,EAAAA,EAAAA,SAAAA,IACO,IAAK9C,EAAUG,KAAMH,EAASG,KAAK4C,KAAK,OAC5CnB,MAAMoB,IACLf,EAAAA,GAAAA,QAAkB,UAClBnC,EAAOmD,QAAQ,CAAEC,KAAM,oBAExBC,SAAQ,KACPN,EAAYhC,OAAQ,MAKpBuC,EAAY,KAChBjC,EAAON,MAAMwC,cACbrD,EAASI,MAAQ,GACjBE,EAAWO,MAAQ,I,syGC1KrB,MAAMyC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,S","sources":["webpack://movie-manager/./src/views/hallInfo/AddHallInfo.vue","webpack://movie-manager/./src/views/hallInfo/AddHallInfo.vue?f2c7"],"sourcesContent":["<template>\r\n  <el-card>\r\n    <template #header>\r\n      <div class=\"flex flex-row justify-between\">\r\n        <span>新增影厅</span>\r\n        <router-link class=\" text-blue-500\" :to=\"{name:'MovieInfoList'}\">返回列表</router-link>\r\n      </div>\r\n    </template>\r\n    <el-form :model=\"formData\" :rules=\"formDataRules\" label-width=\"120px\" ref=\"formEl\">\r\n      <el-form-item label=\"影厅名称\" prop=\"hall_name\">\r\n        <el-input placeholder=\"请输入影厅名称\" v-model=\"formData.hall_name\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"影厅标签\" prop=\"tags\">\r\n        <el-select multiple\r\n          filterable\r\n          allow-create\r\n          default-first-option\r\n          :reserve-keyword=\"false\"\r\n          placeholder=\"请选择影厅标签\"\r\n          v-model=\"formData.tags\"\r\n          class=\"w-full\">\r\n          <el-option :label=\"item\" :value=\"item\" v-for=\"item in ['退','改签','折扣卡','4K厅','全景声','IMAX厅','小吃','杜比全景声']\" :key=\"item\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"影厅地址\" prop=\"address\">\r\n        <el-input placeholder=\"影厅地址\" v-model=\"formData.address\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"影厅坐位\" prop=\"sites\">\r\n        <div class=\"w-full mt-[-5px]\">\r\n          <el-button-group class=\"my-[10px]\">\r\n            <el-button type=\"info\" @click=\"addNewRow\" :icon=\"CirclePlus\">添加一行</el-button>\r\n            <el-button type=\"success\" @click=\"copyLastRow\" :icon=\"DocumentCopy\">复制一行</el-button>\r\n          </el-button-group>\r\n          <el-row class=\"mt-[10px]\">\r\n            <el-col :span=\"12\" class=\" flex flex-row text-[14px]  items-center\">\r\n              <div class=\"w-[30px] h-[26px]\" draggable=\"true\" data-site=\"0\" @dragstart=\"siteDrogStart($event,0)\">\r\n                <img src=\"../../assets/img/00.png\" alt=\"\">\r\n              </div>\r\n              <span class=\"ml-[5px]\">可选</span>\r\n            </el-col>\r\n            <el-col :span=\"12\" class=\" flex flex-row text-[14px]  items-center\">\r\n              <div class=\"w-[30px] h-[26px] border border-dashed border-gray-500\" data-site=\"-1\" draggable=\"true\" @dragstart=\"siteDrogStart($event,-1)\">\r\n              </div>\r\n              <span class=\"ml-[5px]\">空位</span>\r\n            </el-col>\r\n          </el-row>\r\n          <ul class=\"site-list\">\r\n            <li\r\n              @dragend.prevent=\"\" @dragover.prevent=\"\"\r\n              @drop.prevent=\"siteItemDrop($event,index)\"\r\n              v-for=\"(item,index) in siteDetail\" :key=\"index\">\r\n              <el-icon color=\"red\" :size=\"22\" class=\"absolute right-[10px] cursor-pointer\" @click=\"deleteCurrentRow(index)\">\r\n                <CircleCloseFilled />\r\n              </el-icon>\r\n              <div\r\n                class=\"mr-[5px] w-[30px] h-[26px] border  border-gray-500\"\r\n                :class=\"{'border-dashed':site==-1}\"\r\n                v-for=\"(site,index2) in item\" :key=\"index2\">\r\n                <img src=\"../../assets/img/00.png\" v-if=\"site==0\" />\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm\" :loading=\"isSubmiting\">保存数据</el-button>\r\n        <el-button type=\"danger\" @click=\"resetForm\">重置表单</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </el-card>\r\n</template>\r\n<script setup>\r\nimport { ref, reactive, watch } from \"vue\";\r\nimport {\r\n  CircleCloseFilled,\r\n  CirclePlus,\r\n  DocumentCopy,\r\n} from \"@element-plus/icons-vue\";\r\nimport { ElMessageBox, ElMessage } from \"element-plus\";\r\nimport API from \"@/utils/API\";\r\nimport { useRouter } from \"vue-router\";\r\n\r\nconst router = useRouter();\r\nconst formData = reactive({\r\n  hall_name: \"\",\r\n  tags: [],\r\n  sites: \"\",\r\n  address: \"\",\r\n});\r\n\r\nconst siteDetail = ref([]);\r\n\r\n//监听siteDetail的变化\r\nwatch(\r\n  () => siteDetail,\r\n  (newValue, oldValue) => {\r\n    formData.sites = JSON.stringify(siteDetail.value);\r\n  },\r\n  { deep: true }\r\n);\r\n\r\nconst formDataRules = {\r\n  hall_name: [{ required: true, message: \"请输入影厅名称\", trigger: \"blur\" }],\r\n  tags: [{ required: true, message: \"请输入影厅标签\", trigger: \"blur\" }],\r\n  sites: [{ required: true, message: \"请设计影厅座位\", trigger: \"blur\" }],\r\n  address: [{ required: true, message: \"请输入影厅地址\", trigger: \"blur\" }],\r\n};\r\n\r\nconst formEl = ref(null);\r\n\r\n// 添加一行\r\nconst addNewRow = () => {\r\n  siteDetail.value.push([]);\r\n};\r\n\r\n// 删除一行\r\nconst deleteCurrentRow = (index) => {\r\n  ElMessageBox.confirm(\"确定要删除这一行吗？\", \"请确认\", {\r\n    confirmButtonText: \"确定\",\r\n    cancelButtonText: \"取消\",\r\n    type: \"warning\",\r\n  }).then(() => {\r\n    siteDetail.value.splice(index, 1);\r\n  });\r\n};\r\n\r\n//复制一行\r\nconst copyLastRow = () => {\r\n  if (siteDetail.value.length > 0) {\r\n    const lastRow = siteDetail.value[siteDetail.value.length - 1];\r\n    siteDetail.value.push([...lastRow]);\r\n  } else {\r\n    ElMessage.error(\"请先添加一行\");\r\n  }\r\n};\r\n\r\nconst siteDrogStart = (event, site) => {\r\n  event.dataTransfer.setData(\"site\", site);\r\n};\r\n\r\n//手动以后放入的事件\r\nconst siteItemDrop = (event, index) => {\r\n  var site = event.dataTransfer.getData(\"site\");\r\n  siteDetail.value[index].push(+site);\r\n};\r\n\r\n//提交表单\r\nconst submitForm = () => {\r\n  formEl.value.validate((valid) => {\r\n    if (valid) {\r\n      saveDate();\r\n    } else {\r\n      ElMessage.error(\"请将数据填写完整\");\r\n    }\r\n  });\r\n};\r\n\r\n//提交表单以后保存数据的操作\r\nconst isSubmiting = ref(false);\r\nconst saveDate = () => {\r\n  isSubmiting.value = true;\r\n  API.hallInfo\r\n    .add({ ...formData, tags: formData.tags.join(\",\") })\r\n    .then((result) => {\r\n      ElMessage.success(\"数据保存成功\");\r\n      router.replace({ name: \"HallInfoList\" });\r\n    })\r\n    .finally(() => {\r\n      isSubmiting.value = false;\r\n    });\r\n};\r\n\r\n//重置表单\r\nconst resetForm = () => {\r\n  formEl.value.resetFields();\r\n  formData.sites = \"\";\r\n  siteDetail.value = [];\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n.site-list {\r\n  counter-reset: row 0;\r\n  > li {\r\n    counter-increment: row 1;\r\n    @apply h-[40px] border border-solid border-gray-300 flex items-center mt-[10px] relative;\r\n    &::before {\r\n      content: counter(row) \"排\";\r\n      @apply text-[12px] w-[60px] flex flex-row justify-center items-center font-bold;\r\n    }\r\n  }\r\n}\r\n</style>","import script from \"./AddHallInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AddHallInfo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AddHallInfo.vue?vue&type=style&index=0&id=630d4a90&scoped=true&lang=scss\"\n\nimport exportComponent from \"D:\\\\杨标的工作文件\\\\学校文件\\\\华夏学院\\\\2022软工暑假实训\\\\movie-manager-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-630d4a90\"]])\n\nexport default __exports__"],"names":["router","useRouter","formData","reactive","hall_name","tags","sites","address","siteDetail","ref","watch","newValue","oldValue","JSON","stringify","value","deep","formDataRules","required","message","trigger","formEl","addNewRow","push","deleteCurrentRow","index","ElMessageBox","confirmButtonText","cancelButtonText","type","then","splice","copyLastRow","length","lastRow","ElMessage","siteDrogStart","event","site","dataTransfer","setData","siteItemDrop","getData","submitForm","validate","valid","saveDate","isSubmiting","API","join","result","replace","name","finally","resetForm","resetFields","__exports__"],"sourceRoot":""}