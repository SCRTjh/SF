{"version":3,"file":"js/639.2ebc2f12.js","mappings":"sZA+CA,MAAMA,GAAWC,EAAAA,EAAAA,IAAS,CACxBC,UAAW,GACXC,IAAK,GACLC,IAAK,GACLC,MAAO,GACPC,YAAa,KAETC,EAAgB,CACpBL,UAAW,CAAC,CAAEM,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAC3DP,IAAK,CAAC,CAAEK,UAAU,EAAMC,QAAS,QAASC,QAAS,SACnDN,IAAK,CAAC,CAAEI,UAAU,EAAMC,QAAS,QAASC,QAAS,SACnDL,MAAO,CACL,CAAEG,UAAU,EAAMC,QAAS,UAAWC,QAAS,QAC/C,CACEC,QAAS,gBACTF,QAAS,WACTC,QAAS,SAGbJ,YAAa,CAAC,CAAEE,UAAU,EAAMC,QAAS,UAAWC,QAAS,UAGzDE,GAASC,EAAAA,EAAAA,IAAI,MAGbC,GAAmBD,EAAAA,EAAAA,IAAI,IAC7BE,EAAAA,EAAAA,UAAAA,aAEGC,MAAMC,GAAYH,EAAiBI,MAAQD,EAAOE,QAErDC,EAAAA,EAAAA,KACE,IAAMpB,EAASG,MACdkB,IACKA,IACFrB,EAASM,YAAcgB,EAAgBJ,MAAMK,MAC1CC,GAASA,EAAKC,IAAMJ,IACrBK,UAKR,MAAMJ,GAAkBT,EAAAA,EAAAA,IAAI,IAC5BE,EAAAA,EAAAA,SAAAA,aAEGC,MAAMC,GAAYK,EAAgBJ,MAAQD,EAAOE,OAEpD,MAAMQ,EAAa,KACjBf,EAAOM,MAAMU,UAAUC,IACjBA,EACFC,IAEAC,EAAAA,GAAAA,MAAgB,kBAKhBC,GAAcnB,EAAAA,EAAAA,KAAI,GAClBiB,EAAW,KACfE,EAAYd,OAAQ,EACpBH,EAAAA,EAAAA,SAAAA,IACOf,GACJgB,MAAMC,IAELgB,EAAAA,EAAAA,MAAmB,OAAQ,KAAM,CAC/BC,KAAM,UACNC,SAAU,KACRvB,EAAOM,MAAMkB,cACbpC,EAASM,YAAc,SAI5B+B,SAAQ,KACPL,EAAYd,OAAQ,MAIpBoB,EAAY,KAChB1B,EAAOM,MAAMkB,cACbpC,EAASM,YAAc,I,2tEC1HzB,MAAMiC,EAAc,EAEpB","sources":["webpack://movie-manager/./src/views/planInfo/AddPlanInfo.vue","webpack://movie-manager/./src/views/planInfo/AddPlanInfo.vue?3a9a"],"sourcesContent":["<template>\r\n  <el-card>\r\n    <template #header>\r\n      <div class=\"flex flex-row justify-between\">\r\n        <span>新增电影排片</span>\r\n        <router-link class=\" text-blue-500\" :to=\"{name:'PlanInfoList'}\">返回列表</router-link>\r\n      </div>\r\n    </template>\r\n    <el-form label-width=\"120px\" :model=\"formData\" :rules=\"formDataRules\" ref=\"formEl\">\r\n      <el-form-item label=\"排片时间\" prop=\"plan_time\" class=\"w-full\">\r\n        <el-date-picker\r\n          v-model=\"formData.plan_time\"\r\n          type=\"datetime\"\r\n          placeholder=\"请选择排片时间\"\r\n          value-format=\"YYYY-MM-DD HH:mm:ss\" style=\"width: 100%;\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"电影\" prop=\"mid\" class=\"w-full\">\r\n        <el-select v-model=\"formData.mid\" placeholder=\"请选择电影\" class=\"w-full\" filterable>\r\n          <el-option v-for=\"item in allMovieInfoList\"\r\n            :key=\"item.id\" :value=\"item.id\"\r\n            :label=\"item.movie_name\">\r\n            {{item.movie_name}}【{{item.publicTime}}】【{{item.movie_score}}分】\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"影厅\" prop=\"hid\" class=\"w-full\">\r\n        <el-select v-model=\"formData.hid\" placeholder=\"请选择影厅\" class=\"w-full\" filterable>\r\n          <el-option v-for=\"item in allHallInfoList\" :key=\"item.id\" :value=\"item.id\" :label=\"item.hall_name\">\r\n            {{item.hall_name}}\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"价格\" prop=\"price\">\r\n        <el-input placeholder=\"请输入价格\" v-model=\"formData.price\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm\">保存数据</el-button>\r\n        <el-button type=\"danger\" @click=\"resetForm\">重置表单</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </el-card>\r\n</template>\r\n<script setup>\r\nimport API from \"@/utils/API\";\r\nimport { ElMessage, ElMessageBox } from \"element-plus\";\r\nimport { reactive, ref, watch } from \"vue\";\r\n\r\nconst formData = reactive({\r\n  plan_time: \"\",\r\n  hid: \"\",\r\n  mid: \"\",\r\n  price: \"\",\r\n  choose_site: \"\",\r\n});\r\nconst formDataRules = {\r\n  plan_time: [{ required: true, message: \"请选择排片时间\", trigger: \"blur\" }],\r\n  hid: [{ required: true, message: \"请选择影厅\", trigger: \"blur\" }],\r\n  mid: [{ required: true, message: \"请选择电影\", trigger: \"blur\" }],\r\n  price: [\r\n    { required: true, message: \"请输入排片价格\", trigger: \"blur\" },\r\n    {\r\n      pattern: /^\\d+(\\.\\d+)?$/,\r\n      message: \"请输入正确的价格\",\r\n      trigger: \"blur\",\r\n    },\r\n  ],\r\n  choose_site: [{ required: true, message: \"请选择排片场次\", trigger: \"blur\" }],\r\n};\r\n\r\nconst formEl = ref(null);\r\n\r\n//获取所有影厅信息\r\nconst allMovieInfoList = ref([]);\r\nAPI.movieInfo\r\n  .getAllList()\r\n  .then((result) => (allMovieInfoList.value = result.data));\r\n\r\nwatch(\r\n  () => formData.hid,\r\n  (newVal) => {\r\n    if (newVal) {\r\n      formData.choose_site = allHallInfoList.value.find(\r\n        (item) => item.id == newVal\r\n      ).sites;\r\n    }\r\n  }\r\n);\r\n//获取所有影厅\r\nconst allHallInfoList = ref([]);\r\nAPI.hallInfo\r\n  .getAllList()\r\n  .then((result) => (allHallInfoList.value = result.data));\r\n\r\nconst submitForm = () => {\r\n  formEl.value.validate((valid) => {\r\n    if (valid) {\r\n      saveData();\r\n    } else {\r\n      ElMessage.error(\"请将表单信息输入完整\");\r\n    }\r\n  });\r\n};\r\n\r\nconst isSubmiting = ref(false);\r\nconst saveData = () => {\r\n  isSubmiting.value = true;\r\n  API.planInfo\r\n    .add(formData)\r\n    .then((result) => {\r\n      //   ElMessage.success(\"添加成功\");\r\n      ElMessageBox.alert(\"添加成功\", \"提示\", {\r\n        type: \"success\",\r\n        callback: () => {\r\n          formEl.value.resetFields();\r\n          formData.choose_site = \"\";\r\n        },\r\n      });\r\n    })\r\n    .finally(() => {\r\n      isSubmiting.value = false;\r\n    });\r\n};\r\n\r\nconst resetForm = () => {\r\n  formEl.value.resetFields();\r\n  formData.choose_site = \"\";\r\n};\r\n</script>\r\n<style scoped>\r\n</style>","import script from \"./AddPlanInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AddPlanInfo.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["formData","reactive","plan_time","hid","mid","price","choose_site","formDataRules","required","message","trigger","pattern","formEl","ref","allMovieInfoList","API","then","result","value","data","watch","newVal","allHallInfoList","find","item","id","sites","submitForm","validate","valid","saveData","ElMessage","isSubmiting","ElMessageBox","type","callback","resetFields","finally","resetForm","__exports__"],"sourceRoot":""}